âŸ¨ ToNats âŸ© â† â€¢Import "bqn-libs/strings.bqn"

While â† {ğ•â€¢_while_ğ•@}Â´
XOR â† (2â‹†31){ğ•—âŠ¸Ã—âŠ¸+Â´32â€¢bit._xorâ—‹(ğ•—âŠ¸(âŒŠâˆ˜Ã·Ëœâ‹ˆ|))}

âŸ¨a,b,câŸ©â€¿i â† 3â€¿Â¯1âˆ¾âˆ˜â†‘Â¨<ToNatsÂ¨â€¢file.Lines "input17.txt"
n â† â‰ i

Run â† {oğ•ŠâŸ¨p,a,b,câŸ©:
  While {ğ•Š:p<n}â€¿{ğ•Š:
    { op ğ•Š lo:
      co â† loâŠ‘0â€¿1â€¿2â€¿3â€¿aâ€¿bâ€¿câ€¿7
      p+â†©2
      { 0: a â†© âŒŠaÃ·2â‹†co;
        1: b â†© b XOR lo;
        2: b â†© 8|co;
        3: p â†© pâ€¿loâŠ‘Ëœ0â‰ a;
        4: b â†© b XOR c;
        5: oâˆ¾â†© 8|co;
        6: b â†© âŒŠaÃ·2â‹†co;
        7: c â†© âŒŠaÃ·2â‹†co
      }op
    }Â´âŸ¨p,p+1âŸ©âŠi
  }
  o
}
â€¢Out âˆ¾âŸœ','âŠ¸âˆ¾Â´ '0' + âŸ¨âŸ©Run 0â€¿aâ€¿bâ€¿c

T â† {(ğ•¨â†“i)â‰¡âŸ¨âŸ©RunâŸ¨0,ğ•©,a,bâŸ©}
â€¢Show n {0<ğ•¨? âŒŠÂ´(ğ•¨-1)Tâ—¶âˆâ€¿ğ•ŠÂ¨8â†•âŠ¸+8Ã—ğ•©; ğ•©} 0
