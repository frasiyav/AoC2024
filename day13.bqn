âŸ¨ ToNats âŸ© â† â€¢Import "bqn-libs/strings.bqn"

p2 â† 0â€¿0â€¿1e13 + p1 â† â‰>âˆ˜â€¿3â€¿2â¥Šâˆ¾ToNatsÂ¨â€¢file.Lines "input13.txt"

Round â† Ã—Ã—Â·âŒˆÂ¯0.5+|

F â† {
  [a,b,p] â† [[ax,ay],[bx,by],[px,py]] â† ğ•©
  nb â† (py-axÃ·ËœpxÃ—ay) Ã· by-axÃ·ËœbxÃ—ay
  na â† axÃ·Ëœpx-bxÃ—nb
  n â† Round [na,nb]
  +Â´â¥Š 3â€¿1 Ã— n Ã—â‰1 âˆ§Ëp=+ËnÃ—â‰1[a,b]
}

â€¢Show FÂ¨ p1â€¿p2
