âŸ¨ ToNats âŸ© â† â€¢Import "bqn-libs/strings.bqn"

i â† âˆ˜â€¿3â€¿2â¥Šâˆ¾ToNatsÂ¨â€¢file.Lines "input13.txt"
p2 â† 0â€¿0â€¿1e13 + p1 â† â‰>i

Round â† Ã—Ã—Â·âŒˆÂ¯0.5+|

F â† {
  [a,b,p] â† [[ax,ay],[bx,by],[px,py]] â† ğ•©
  nb â† (py-axÃ·ËœpxÃ—ay) Ã· by-axÃ·ËœbxÃ—ay
  na â† axÃ·Ëœpx-bxÃ—nb
  n â† Round [na,nb]
  +Â´â¥Š 3â€¿1 Ã— n Ã—â‰1 âˆ§Ëp=+ËnÃ—â‰1[a,b]
}

â€¢Show FÂ¨ p1â€¿p2


# Solution using bqn-libs/matrix:

# {
# âŸ¨ MP, Inverse âŸ© â† â€¢Import "bqn-libs/matrix.bqn"
#
# p2 â† 1e13â€¿0âŠ¸+Ë˜ p1 â† (âŠ¢Ëâ‹ˆ2â†‘âŠ¢)Ë˜i
#
# Round â† Ã—Ã—Â·âŒˆÂ¯0.5+|
# F â† +Â´âˆ˜â¥Š {3â€¿1 Ã— (âˆ§Â´ğ•¨=MPâŸœğ•©)âŠ¸Ã— Round ğ•¨ MP Inverse ğ•©}Â´Ë˜
# â€¢SHow FÂ¨ p1â€¿p2
# }
